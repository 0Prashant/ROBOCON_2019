ARM GAS  C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"pid.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.global	__aeabi_f2d
  18              		.section	.text.PID_setGains,"ax",%progbits
  19              		.align	1
  20              		.global	PID_setGains
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	PID_setGains:
  27              	.LFB126:
  28              		.file 1 "Core/Src/pid.c"
   1:Core/Src/pid.c **** /*2-11-2018*/
   2:Core/Src/pid.c **** 
   3:Core/Src/pid.c **** #include "pid.h"
   4:Core/Src/pid.c **** 
   5:Core/Src/pid.c **** void PID_setGains(struct pidStr *pid, float kp, float ki, float kd)
   6:Core/Src/pid.c **** {
  29              		.loc 1 6 0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              	.LVL0:
  34 0000 70B5     		push	{r4, r5, r6, lr}
  35              	.LCFI0:
  36              		.cfi_def_cfa_offset 16
  37              		.cfi_offset 4, -16
  38              		.cfi_offset 5, -12
  39              		.cfi_offset 6, -8
  40              		.cfi_offset 14, -4
  41 0002 0446     		mov	r4, r0
  42 0004 10EE906A 		vmov	r6, s1
  43 0008 11EE105A 		vmov	r5, s2
   7:Core/Src/pid.c **** 	pid->kp = kp;
  44              		.loc 1 7 0
  45 000c 10EE100A 		vmov	r0, s0
  46              	.LVL1:
  47 0010 FFF7FEFF 		bl	__aeabi_f2d
  48              	.LVL2:
  49 0014 C4E90001 		strd	r0, [r4]
   8:Core/Src/pid.c **** 	pid->ki = ki;
  50              		.loc 1 8 0
ARM GAS  C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s 			page 2


  51 0018 3046     		mov	r0, r6	@ float
  52 001a FFF7FEFF 		bl	__aeabi_f2d
  53              	.LVL3:
  54 001e C4E90201 		strd	r0, [r4, #8]
   9:Core/Src/pid.c **** 	pid->kd = kd;
  55              		.loc 1 9 0
  56 0022 2846     		mov	r0, r5	@ float
  57 0024 FFF7FEFF 		bl	__aeabi_f2d
  58              	.LVL4:
  59 0028 C4E90401 		strd	r0, [r4, #16]
  10:Core/Src/pid.c **** }
  60              		.loc 1 10 0
  61 002c 70BD     		pop	{r4, r5, r6, pc}
  62              		.cfi_endproc
  63              	.LFE126:
  65              		.section	.text.PID_Init,"ax",%progbits
  66              		.align	1
  67              		.global	PID_Init
  68              		.syntax unified
  69              		.thumb
  70              		.thumb_func
  71              		.fpu fpv4-sp-d16
  73              	PID_Init:
  74              	.LFB127:
  11:Core/Src/pid.c **** 
  12:Core/Src/pid.c **** void PID_Init(struct pidStr *pid)
  13:Core/Src/pid.c **** {
  75              		.loc 1 13 0
  76              		.cfi_startproc
  77              		@ args = 0, pretend = 0, frame = 0
  78              		@ frame_needed = 0, uses_anonymous_args = 0
  79              		@ link register save eliminated.
  80              	.LVL5:
  14:Core/Src/pid.c **** 	pid->output = 0;
  81              		.loc 1 14 0
  82 0000 0023     		movs	r3, #0
  83 0002 C361     		str	r3, [r0, #28]	@ float
  15:Core/Src/pid.c **** 	pid->last_error = 0;
  84              		.loc 1 15 0
  85 0004 C362     		str	r3, [r0, #44]	@ float
  16:Core/Src/pid.c **** 	pid->max_output = 0;
  86              		.loc 1 16 0
  87 0006 0362     		str	r3, [r0, #32]	@ float
  17:Core/Src/pid.c **** 	pid->min_output = 0;
  88              		.loc 1 17 0
  89 0008 4362     		str	r3, [r0, #36]	@ float
  18:Core/Src/pid.c **** }
  90              		.loc 1 18 0
  91 000a 7047     		bx	lr
  92              		.cfi_endproc
  93              	.LFE127:
  95              		.global	__aeabi_dmul
  96              		.global	__aeabi_ddiv
  97              		.global	__aeabi_d2f
  98              		.global	__aeabi_dadd
  99              		.section	.text.PID_Compute,"ax",%progbits
 100              		.align	1
ARM GAS  C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s 			page 3


 101              		.global	PID_Compute
 102              		.syntax unified
 103              		.thumb
 104              		.thumb_func
 105              		.fpu fpv4-sp-d16
 107              	PID_Compute:
 108              	.LFB128:
  19:Core/Src/pid.c **** 
  20:Core/Src/pid.c **** float PID_Compute(struct pidStr *pid, float set_point, float input, uint16_t dt)
  21:Core/Src/pid.c **** {
 109              		.loc 1 21 0
 110              		.cfi_startproc
 111              		@ args = 0, pretend = 0, frame = 0
 112              		@ frame_needed = 0, uses_anonymous_args = 0
 113              	.LVL6:
 114 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 115              	.LCFI1:
 116              		.cfi_def_cfa_offset 32
 117              		.cfi_offset 3, -32
 118              		.cfi_offset 4, -28
 119              		.cfi_offset 5, -24
 120              		.cfi_offset 6, -20
 121              		.cfi_offset 7, -16
 122              		.cfi_offset 8, -12
 123              		.cfi_offset 9, -8
 124              		.cfi_offset 14, -4
 125 0004 2DED048B 		vpush.64	{d8, d9}
 126              	.LCFI2:
 127              		.cfi_def_cfa_offset 48
 128              		.cfi_offset 80, -48
 129              		.cfi_offset 81, -44
 130              		.cfi_offset 82, -40
 131              		.cfi_offset 83, -36
 132 0008 0446     		mov	r4, r0
 133 000a 09EE101A 		vmov	s18, r1	@ int
  22:Core/Src/pid.c **** 	float error = set_point - input;
 134              		.loc 1 22 0
 135 000e 30EE608A 		vsub.f32	s16, s0, s1
 136              	.LVL7:
  23:Core/Src/pid.c **** 
  24:Core/Src/pid.c **** 	float i_term = dt * error / 1000;
 137              		.loc 1 24 0
 138 0012 F8EEC97A 		vcvt.f32.s32	s15, s18
 139 0016 67EE887A 		vmul.f32	s15, s15, s16
 140 001a 9FED457A 		vldr.32	s14, .L12
 141 001e C7EE879A 		vdiv.f32	s19, s15, s14
 142              	.LVL8:
  25:Core/Src/pid.c **** 	float d_term = (error - 2 * pid->last_error + pid->previous_error) * 1000.0 / (float)dt;
 143              		.loc 1 25 0
 144 0022 D0ED0B8A 		vldr.32	s17, [r0, #44]
 145 0026 78EEA87A 		vadd.f32	s15, s17, s17
 146 002a 78EE677A 		vsub.f32	s15, s16, s15
 147 002e 90ED0C7A 		vldr.32	s14, [r0, #48]
 148 0032 77EE877A 		vadd.f32	s15, s15, s14
 149 0036 17EE900A 		vmov	r0, s15
 150              	.LVL9:
 151 003a FFF7FEFF 		bl	__aeabi_f2d
ARM GAS  C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s 			page 4


 152              	.LVL10:
 153 003e 0022     		movs	r2, #0
 154 0040 3C4B     		ldr	r3, .L12+4
 155 0042 FFF7FEFF 		bl	__aeabi_dmul
 156              	.LVL11:
 157 0046 0646     		mov	r6, r0
 158 0048 0F46     		mov	r7, r1
 159 004a F8EE497A 		vcvt.f32.u32	s15, s18
 160 004e 17EE900A 		vmov	r0, s15
 161 0052 FFF7FEFF 		bl	__aeabi_f2d
 162              	.LVL12:
 163 0056 0246     		mov	r2, r0
 164 0058 0B46     		mov	r3, r1
 165 005a 3046     		mov	r0, r6
 166 005c 3946     		mov	r1, r7
 167 005e FFF7FEFF 		bl	__aeabi_ddiv
 168              	.LVL13:
 169 0062 FFF7FEFF 		bl	__aeabi_d2f
 170              	.LVL14:
 171 0066 0546     		mov	r5, r0	@ float
 172              	.LVL15:
  26:Core/Src/pid.c **** 
  27:Core/Src/pid.c **** 	pid->output = pid->last_output + pid->kp * error + pid->ki * i_term + pid->kd * d_term;
 173              		.loc 1 27 0
 174 0068 A06A     		ldr	r0, [r4, #40]	@ float
 175              	.LVL16:
 176 006a FFF7FEFF 		bl	__aeabi_f2d
 177              	.LVL17:
 178 006e 0646     		mov	r6, r0
 179 0070 0F46     		mov	r7, r1
 180 0072 D4E90089 		ldrd	r8, [r4]
 181 0076 18EE100A 		vmov	r0, s16
 182 007a FFF7FEFF 		bl	__aeabi_f2d
 183              	.LVL18:
 184 007e 4246     		mov	r2, r8
 185 0080 4B46     		mov	r3, r9
 186 0082 FFF7FEFF 		bl	__aeabi_dmul
 187              	.LVL19:
 188 0086 0246     		mov	r2, r0
 189 0088 0B46     		mov	r3, r1
 190 008a 3046     		mov	r0, r6
 191 008c 3946     		mov	r1, r7
 192 008e FFF7FEFF 		bl	__aeabi_dadd
 193              	.LVL20:
 194 0092 0646     		mov	r6, r0
 195 0094 0F46     		mov	r7, r1
 196 0096 D4E90289 		ldrd	r8, [r4, #8]
 197 009a 19EE900A 		vmov	r0, s19
 198 009e FFF7FEFF 		bl	__aeabi_f2d
 199              	.LVL21:
 200 00a2 4246     		mov	r2, r8
 201 00a4 4B46     		mov	r3, r9
 202 00a6 FFF7FEFF 		bl	__aeabi_dmul
 203              	.LVL22:
 204 00aa 0246     		mov	r2, r0
 205 00ac 0B46     		mov	r3, r1
 206 00ae 3046     		mov	r0, r6
ARM GAS  C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s 			page 5


 207 00b0 3946     		mov	r1, r7
 208 00b2 FFF7FEFF 		bl	__aeabi_dadd
 209              	.LVL23:
 210 00b6 0646     		mov	r6, r0
 211 00b8 0F46     		mov	r7, r1
 212 00ba D4E90489 		ldrd	r8, [r4, #16]
 213 00be 2846     		mov	r0, r5	@ float
 214 00c0 FFF7FEFF 		bl	__aeabi_f2d
 215              	.LVL24:
 216 00c4 4246     		mov	r2, r8
 217 00c6 4B46     		mov	r3, r9
 218 00c8 FFF7FEFF 		bl	__aeabi_dmul
 219              	.LVL25:
 220 00cc 0246     		mov	r2, r0
 221 00ce 0B46     		mov	r3, r1
 222 00d0 3046     		mov	r0, r6
 223 00d2 3946     		mov	r1, r7
 224 00d4 FFF7FEFF 		bl	__aeabi_dadd
 225              	.LVL26:
 226 00d8 FFF7FEFF 		bl	__aeabi_d2f
 227              	.LVL27:
 228 00dc 07EE900A 		vmov	s15, r0
 229 00e0 E061     		str	r0, [r4, #28]	@ float
  28:Core/Src/pid.c **** 
  29:Core/Src/pid.c **** 	pid->last_output = pid->output;
 230              		.loc 1 29 0
 231 00e2 A062     		str	r0, [r4, #40]	@ float
  30:Core/Src/pid.c **** 	pid->previous_error = pid->last_error;
 232              		.loc 1 30 0
 233 00e4 C4ED0C8A 		vstr.32	s17, [r4, #48]
  31:Core/Src/pid.c **** 	pid->last_error = error;
 234              		.loc 1 31 0
 235 00e8 84ED0B8A 		vstr.32	s16, [r4, #44]
  32:Core/Src/pid.c **** 
  33:Core/Src/pid.c **** 	if (pid->output > (pid->max_output))
 236              		.loc 1 33 0
 237 00ec 94ED087A 		vldr.32	s14, [r4, #32]
 238 00f0 F4EEC77A 		vcmpe.f32	s15, s14
 239 00f4 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 240 00f8 01DD     		ble	.L5
  34:Core/Src/pid.c **** 	{
  35:Core/Src/pid.c **** 		pid->output = (pid->max_output);
 241              		.loc 1 35 0
 242 00fa 84ED077A 		vstr.32	s14, [r4, #28]
 243              	.L5:
  36:Core/Src/pid.c **** 	}
  37:Core/Src/pid.c **** 
  38:Core/Src/pid.c **** 	if (pid->output < (pid->min_output))
 244              		.loc 1 38 0
 245 00fe 94ED077A 		vldr.32	s14, [r4, #28]
 246 0102 D4ED097A 		vldr.32	s15, [r4, #36]
 247 0106 B4EEE77A 		vcmpe.f32	s14, s15
 248 010a F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 249 010e 01D5     		bpl	.L7
  39:Core/Src/pid.c **** 	{
  40:Core/Src/pid.c **** 		pid->output = (pid->min_output);
 250              		.loc 1 40 0
ARM GAS  C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s 			page 6


 251 0110 C4ED077A 		vstr.32	s15, [r4, #28]
 252              	.L7:
  41:Core/Src/pid.c **** 	}
  42:Core/Src/pid.c **** 
  43:Core/Src/pid.c **** 	return (pid->output * 17) / 24;
 253              		.loc 1 43 0
 254 0114 D4ED077A 		vldr.32	s15, [r4, #28]
 255 0118 B3EE010A 		vmov.f32	s0, #1.7e+1
 256 011c 67EE807A 		vmul.f32	s15, s15, s0
  44:Core/Src/pid.c **** }
 257              		.loc 1 44 0
 258 0120 B3EE080A 		vmov.f32	s0, #2.4e+1
 259 0124 87EE800A 		vdiv.f32	s0, s15, s0
 260 0128 BDEC048B 		vldm	sp!, {d8-d9}
 261              	.LCFI3:
 262              		.cfi_restore 82
 263              		.cfi_restore 83
 264              		.cfi_restore 80
 265              		.cfi_restore 81
 266              		.cfi_def_cfa_offset 32
 267              	.LVL28:
 268 012c BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 269              	.LVL29:
 270              	.L13:
 271              		.align	2
 272              	.L12:
 273 0130 00007A44 		.word	1148846080
 274 0134 00408F40 		.word	1083129856
 275              		.cfi_endproc
 276              	.LFE128:
 278              		.section	.text.PID_resetParams,"ax",%progbits
 279              		.align	1
 280              		.global	PID_resetParams
 281              		.syntax unified
 282              		.thumb
 283              		.thumb_func
 284              		.fpu fpv4-sp-d16
 286              	PID_resetParams:
 287              	.LFB129:
  45:Core/Src/pid.c **** 
  46:Core/Src/pid.c **** void PID_resetParams(struct pidStr *pid)
  47:Core/Src/pid.c **** {
 288              		.loc 1 47 0
 289              		.cfi_startproc
 290              		@ args = 0, pretend = 0, frame = 0
 291              		@ frame_needed = 0, uses_anonymous_args = 0
 292              		@ link register save eliminated.
 293              	.LVL30:
  48:Core/Src/pid.c **** 	pid->last_error = 0;
 294              		.loc 1 48 0
 295 0000 0023     		movs	r3, #0
 296 0002 C362     		str	r3, [r0, #44]	@ float
  49:Core/Src/pid.c **** 	pid->output = 0;
 297              		.loc 1 49 0
 298 0004 C361     		str	r3, [r0, #28]	@ float
  50:Core/Src/pid.c **** 	pid->previous_error = 0;
 299              		.loc 1 50 0
ARM GAS  C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s 			page 7


 300 0006 0363     		str	r3, [r0, #48]	@ float
  51:Core/Src/pid.c **** 	pid->last_output = 0;
 301              		.loc 1 51 0
 302 0008 8362     		str	r3, [r0, #40]	@ float
  52:Core/Src/pid.c **** }
 303              		.loc 1 52 0
 304 000a 7047     		bx	lr
 305              		.cfi_endproc
 306              	.LFE129:
 308              		.section	.text.PID_setOutputLimit,"ax",%progbits
 309              		.align	1
 310              		.global	PID_setOutputLimit
 311              		.syntax unified
 312              		.thumb
 313              		.thumb_func
 314              		.fpu fpv4-sp-d16
 316              	PID_setOutputLimit:
 317              	.LFB130:
  53:Core/Src/pid.c **** 
  54:Core/Src/pid.c **** void PID_setOutputLimit(struct pidStr *pid, float max_output, float min_output)
  55:Core/Src/pid.c **** {
 318              		.loc 1 55 0
 319              		.cfi_startproc
 320              		@ args = 0, pretend = 0, frame = 0
 321              		@ frame_needed = 0, uses_anonymous_args = 0
 322              		@ link register save eliminated.
 323              	.LVL31:
  56:Core/Src/pid.c **** 	pid->max_output = max_output;
 324              		.loc 1 56 0
 325 0000 80ED080A 		vstr.32	s0, [r0, #32]
  57:Core/Src/pid.c **** 	pid->min_output = min_output;
 326              		.loc 1 57 0
 327 0004 C0ED090A 		vstr.32	s1, [r0, #36]
  58:Core/Src/pid.c **** }
 328              		.loc 1 58 0
 329 0008 7047     		bx	lr
 330              		.cfi_endproc
 331              	.LFE130:
 333              		.text
 334              	.Letext0:
 335              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 336              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 337              		.file 4 "C:/Users/Prashant/STM32Cube/Repository/STM32Cube_FW_F4_V1.21.0/Drivers/CMSIS/Include/core
 338              		.file 5 "C:/Users/Prashant/STM32Cube/Repository/STM32Cube_FW_F4_V1.21.0/Drivers/CMSIS/Device/ST/ST
 339              		.file 6 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 340              		.file 7 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 341              		.file 8 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\lib\\gcc\\arm-none-eabi
 342              		.file 9 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 343              		.file 10 "Core/Inc/pid.h"
ARM GAS  C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s 			page 8


DEFINED SYMBOLS
                            *ABS*:00000000 pid.c
C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s:19     .text.PID_setGains:00000000 $t
C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s:26     .text.PID_setGains:00000000 PID_setGains
C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s:66     .text.PID_Init:00000000 $t
C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s:73     .text.PID_Init:00000000 PID_Init
C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s:100    .text.PID_Compute:00000000 $t
C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s:107    .text.PID_Compute:00000000 PID_Compute
C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s:273    .text.PID_Compute:00000130 $d
C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s:279    .text.PID_resetParams:00000000 $t
C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s:286    .text.PID_resetParams:00000000 PID_resetParams
C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s:309    .text.PID_setOutputLimit:00000000 $t
C:\Users\Prashant\AppData\Local\Temp\ccLmnv0w.s:316    .text.PID_setOutputLimit:00000000 PID_setOutputLimit

UNDEFINED SYMBOLS
__aeabi_f2d
__aeabi_dmul
__aeabi_ddiv
__aeabi_d2f
__aeabi_dadd
