ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"wheel.cpp"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text._ZL11time_periodt,"ax",%progbits
  18              		.align	1
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu fpv4-sp-d16
  24              	_ZL11time_periodt:
  25              	.LFB405:
  26              		.file 1 "Core/Src/devs/wheel.cpp"
   1:Core/Src/devs/wheel.cpp **** /*
   2:Core/Src/devs/wheel.cpp ****  * wheel.c
   3:Core/Src/devs/wheel.cpp ****  *
   4:Core/Src/devs/wheel.cpp ****  * Created : 10/1/2018
   5:Core/Src/devs/wheel.cpp ****  */
   6:Core/Src/devs/wheel.cpp **** 
   7:Core/Src/devs/wheel.cpp **** #include "wheel.h"
   8:Core/Src/devs/wheel.cpp **** #include <math.h>
   9:Core/Src/devs/wheel.cpp **** 
  10:Core/Src/devs/wheel.cpp **** static uint16_t time_period(uint16_t PWM_frequency)
  11:Core/Src/devs/wheel.cpp **** {
  27              		.loc 1 11 0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              	.LVL0:
  32 0000 10B5     		push	{r4, lr}
  33              	.LCFI0:
  34              		.cfi_def_cfa_offset 8
  35              		.cfi_offset 4, -8
  36              		.cfi_offset 14, -4
  37 0002 0446     		mov	r4, r0
  12:Core/Src/devs/wheel.cpp ****         if (PWM_frequency < 2000) { //MIN PWM_FREQUENCY = 1281.738 for time period to be 16 bit
  38              		.loc 1 12 0
  39 0004 B0F5FA6F 		cmp	r0, #2000
  40 0008 06D3     		bcc	.L4
  41              	.LVL1:
  42              	.L2:
  13:Core/Src/devs/wheel.cpp ****                 _Error_Handler(__FILE__, __LINE__);
  14:Core/Src/devs/wheel.cpp ****         }
  15:Core/Src/devs/wheel.cpp ****         return ((PWM_TIMER_FREQUENCY / 2) / PWM_frequency) - 1; // In Center aligned mode period do
  43              		.loc 1 15 0
ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 2


  44 000a 0648     		ldr	r0, .L5
  45 000c 90FBF4F0 		sdiv	r0, r0, r4
  46 0010 80B2     		uxth	r0, r0
  47 0012 0138     		subs	r0, r0, #1
  16:Core/Src/devs/wheel.cpp **** }
  48              		.loc 1 16 0
  49 0014 80B2     		uxth	r0, r0
  50 0016 10BD     		pop	{r4, pc}
  51              	.LVL2:
  52              	.L4:
  13:Core/Src/devs/wheel.cpp ****                 _Error_Handler(__FILE__, __LINE__);
  53              		.loc 1 13 0
  54 0018 0D21     		movs	r1, #13
  55 001a 0348     		ldr	r0, .L5+4
  56              	.LVL3:
  57 001c FFF7FEFF 		bl	_Error_Handler
  58              	.LVL4:
  59 0020 F3E7     		b	.L2
  60              	.L6:
  61 0022 00BF     		.align	2
  62              	.L5:
  63 0024 00BD0105 		.word	84000000
  64 0028 00000000 		.word	.LC0
  65              		.cfi_endproc
  66              	.LFE405:
  68              		.section	.text._ZL18set_WheelDirectionP12Wheel_Config9Direction,"ax",%progbits
  69              		.align	1
  70              		.syntax unified
  71              		.thumb
  72              		.thumb_func
  73              		.fpu fpv4-sp-d16
  75              	_ZL18set_WheelDirectionP12Wheel_Config9Direction:
  76              	.LFB408:
  17:Core/Src/devs/wheel.cpp **** 
  18:Core/Src/devs/wheel.cpp **** /* SET DUTYCYCLE primary function */
  19:Core/Src/devs/wheel.cpp **** void set_DutyCycle_Primary(TIM_HandleTypeDef *htim, uint32_t Channel, uint16_t dutyCycle)
  20:Core/Src/devs/wheel.cpp **** {
  21:Core/Src/devs/wheel.cpp ****         uint16_t mapped_value;
  22:Core/Src/devs/wheel.cpp ****         mapped_value = (time_period(MOTOR_DRIVER_FREQUENCY) * dutyCycle) / 65535;
  23:Core/Src/devs/wheel.cpp ****         __HAL_TIM_SET_COMPARE(htim, Channel, mapped_value);
  24:Core/Src/devs/wheel.cpp **** }
  25:Core/Src/devs/wheel.cpp **** 
  26:Core/Src/devs/wheel.cpp **** static void set_DutyCycle(Wheel_Config *w, uint16_t dutyCycle)
  27:Core/Src/devs/wheel.cpp **** {
  28:Core/Src/devs/wheel.cpp ****         set_DutyCycle_Primary(w->htim, w->channel, dutyCycle);
  29:Core/Src/devs/wheel.cpp **** }
  30:Core/Src/devs/wheel.cpp **** 
  31:Core/Src/devs/wheel.cpp **** static void set_WheelDirection(Wheel_Config *w, Direction d)
  32:Core/Src/devs/wheel.cpp **** {
  77              		.loc 1 32 0
  78              		.cfi_startproc
  79              		@ args = 0, pretend = 0, frame = 0
  80              		@ frame_needed = 0, uses_anonymous_args = 0
  81              	.LVL5:
  82 0000 10B5     		push	{r4, lr}
  83              	.LCFI1:
  84              		.cfi_def_cfa_offset 8
ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 3


  85              		.cfi_offset 4, -8
  86              		.cfi_offset 14, -4
  87 0002 0446     		mov	r4, r0
  33:Core/Src/devs/wheel.cpp ****         if (d == Direction::AHEAD)       // AHEAD
  88              		.loc 1 33 0
  89 0004 61B1     		cbz	r1, .L12
  34:Core/Src/devs/wheel.cpp ****         {
  35:Core/Src/devs/wheel.cpp ****                 HAL_GPIO_WritePin(w->in1_port, w->in1_pin, GPIO_PIN_SET);
  36:Core/Src/devs/wheel.cpp ****                 HAL_GPIO_WritePin(w->in2_port, w->in2_pin, GPIO_PIN_RESET);
  37:Core/Src/devs/wheel.cpp ****         }
  38:Core/Src/devs/wheel.cpp ****         else if (d == Direction::BACK)  // BACK
  90              		.loc 1 38 0
  91 0006 0129     		cmp	r1, #1
  92 0008 15D0     		beq	.L13
  39:Core/Src/devs/wheel.cpp ****         {
  40:Core/Src/devs/wheel.cpp ****                 HAL_GPIO_WritePin(w->in1_port, w->in1_pin, GPIO_PIN_RESET);
  41:Core/Src/devs/wheel.cpp ****                 HAL_GPIO_WritePin(w->in2_port, w->in2_pin, GPIO_PIN_SET);
  42:Core/Src/devs/wheel.cpp ****         }
  43:Core/Src/devs/wheel.cpp ****         else                    // HALT
  44:Core/Src/devs/wheel.cpp ****         {
  45:Core/Src/devs/wheel.cpp ****                 HAL_GPIO_WritePin(w->in1_port, w->in1_pin, GPIO_PIN_RESET);
  93              		.loc 1 45 0
  94 000a 0022     		movs	r2, #0
  95 000c 8189     		ldrh	r1, [r0, #12]
  96              	.LVL6:
  97 000e 8068     		ldr	r0, [r0, #8]
  98              	.LVL7:
  99 0010 FFF7FEFF 		bl	HAL_GPIO_WritePin
 100              	.LVL8:
  46:Core/Src/devs/wheel.cpp ****                 HAL_GPIO_WritePin(w->in2_port, w->in2_pin, GPIO_PIN_RESET);
 101              		.loc 1 46 0
 102 0014 0022     		movs	r2, #0
 103 0016 A18A     		ldrh	r1, [r4, #20]
 104 0018 2069     		ldr	r0, [r4, #16]
 105 001a FFF7FEFF 		bl	HAL_GPIO_WritePin
 106              	.LVL9:
 107              	.L7:
  47:Core/Src/devs/wheel.cpp ****         }
  48:Core/Src/devs/wheel.cpp **** }
 108              		.loc 1 48 0
 109 001e 10BD     		pop	{r4, pc}
 110              	.LVL10:
 111              	.L12:
  35:Core/Src/devs/wheel.cpp ****                 HAL_GPIO_WritePin(w->in2_port, w->in2_pin, GPIO_PIN_RESET);
 112              		.loc 1 35 0
 113 0020 0122     		movs	r2, #1
 114 0022 8189     		ldrh	r1, [r0, #12]
 115              	.LVL11:
 116 0024 8068     		ldr	r0, [r0, #8]
 117              	.LVL12:
 118 0026 FFF7FEFF 		bl	HAL_GPIO_WritePin
 119              	.LVL13:
  36:Core/Src/devs/wheel.cpp ****         }
 120              		.loc 1 36 0
 121 002a 0022     		movs	r2, #0
 122 002c A18A     		ldrh	r1, [r4, #20]
 123 002e 2069     		ldr	r0, [r4, #16]
ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 4


 124 0030 FFF7FEFF 		bl	HAL_GPIO_WritePin
 125              	.LVL14:
 126 0034 F3E7     		b	.L7
 127              	.LVL15:
 128              	.L13:
  40:Core/Src/devs/wheel.cpp ****                 HAL_GPIO_WritePin(w->in2_port, w->in2_pin, GPIO_PIN_SET);
 129              		.loc 1 40 0
 130 0036 0022     		movs	r2, #0
 131 0038 8189     		ldrh	r1, [r0, #12]
 132              	.LVL16:
 133 003a 8068     		ldr	r0, [r0, #8]
 134              	.LVL17:
 135 003c FFF7FEFF 		bl	HAL_GPIO_WritePin
 136              	.LVL18:
  41:Core/Src/devs/wheel.cpp ****         }
 137              		.loc 1 41 0
 138 0040 0122     		movs	r2, #1
 139 0042 A18A     		ldrh	r1, [r4, #20]
 140 0044 2069     		ldr	r0, [r4, #16]
 141 0046 FFF7FEFF 		bl	HAL_GPIO_WritePin
 142              	.LVL19:
 143 004a E8E7     		b	.L7
 144              		.cfi_endproc
 145              	.LFE408:
 147              		.section	.text._Z21set_DutyCycle_PrimaryP17TIM_HandleTypeDefmt,"ax",%progbits
 148              		.align	1
 149              		.global	_Z21set_DutyCycle_PrimaryP17TIM_HandleTypeDefmt
 150              		.syntax unified
 151              		.thumb
 152              		.thumb_func
 153              		.fpu fpv4-sp-d16
 155              	_Z21set_DutyCycle_PrimaryP17TIM_HandleTypeDefmt:
 156              	.LFB406:
  20:Core/Src/devs/wheel.cpp ****         uint16_t mapped_value;
 157              		.loc 1 20 0
 158              		.cfi_startproc
 159              		@ args = 0, pretend = 0, frame = 0
 160              		@ frame_needed = 0, uses_anonymous_args = 0
 161              	.LVL20:
 162 0000 70B5     		push	{r4, r5, r6, lr}
 163              	.LCFI2:
 164              		.cfi_def_cfa_offset 16
 165              		.cfi_offset 4, -16
 166              		.cfi_offset 5, -12
 167              		.cfi_offset 6, -8
 168              		.cfi_offset 14, -4
 169 0002 0646     		mov	r6, r0
 170 0004 0D46     		mov	r5, r1
 171 0006 1446     		mov	r4, r2
  22:Core/Src/devs/wheel.cpp ****         __HAL_TIM_SET_COMPARE(htim, Channel, mapped_value);
 172              		.loc 1 22 0
 173 0008 4FF4FA50 		mov	r0, #8000
 174              	.LVL21:
 175 000c FFF7FEFF 		bl	_ZL11time_periodt
 176              	.LVL22:
 177 0010 00FB04F0 		mul	r0, r0, r4
 178 0014 064B     		ldr	r3, .L16
ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 5


 179 0016 83FB0023 		smull	r2, r3, r3, r0
 180 001a 0344     		add	r3, r3, r0
 181 001c C017     		asrs	r0, r0, #31
 182 001e C0EBE330 		rsb	r0, r0, r3, asr #15
 183              	.LVL23:
  23:Core/Src/devs/wheel.cpp **** }
 184              		.loc 1 23 0
 185 0022 3368     		ldr	r3, [r6]
 186 0024 3433     		adds	r3, r3, #52
 187 0026 AD08     		lsrs	r5, r5, #2
 188              	.LVL24:
 189 0028 80B2     		uxth	r0, r0
 190 002a 43F82500 		str	r0, [r3, r5, lsl #2]
 191              	.LVL25:
  24:Core/Src/devs/wheel.cpp **** 
 192              		.loc 1 24 0
 193 002e 70BD     		pop	{r4, r5, r6, pc}
 194              	.LVL26:
 195              	.L17:
 196              		.align	2
 197              	.L16:
 198 0030 01800080 		.word	-2147450879
 199              		.cfi_endproc
 200              	.LFE406:
 202              		.section	.text._ZL13set_DutyCycleP12Wheel_Configt,"ax",%progbits
 203              		.align	1
 204              		.syntax unified
 205              		.thumb
 206              		.thumb_func
 207              		.fpu fpv4-sp-d16
 209              	_ZL13set_DutyCycleP12Wheel_Configt:
 210              	.LFB407:
  27:Core/Src/devs/wheel.cpp ****         set_DutyCycle_Primary(w->htim, w->channel, dutyCycle);
 211              		.loc 1 27 0
 212              		.cfi_startproc
 213              		@ args = 0, pretend = 0, frame = 0
 214              		@ frame_needed = 0, uses_anonymous_args = 0
 215              	.LVL27:
 216 0000 08B5     		push	{r3, lr}
 217              	.LCFI3:
 218              		.cfi_def_cfa_offset 8
 219              		.cfi_offset 3, -8
 220              		.cfi_offset 14, -4
  28:Core/Src/devs/wheel.cpp **** }
 221              		.loc 1 28 0
 222 0002 0A46     		mov	r2, r1
 223 0004 C169     		ldr	r1, [r0, #28]
 224              	.LVL28:
 225 0006 8069     		ldr	r0, [r0, #24]
 226              	.LVL29:
 227 0008 FFF7FEFF 		bl	_Z21set_DutyCycle_PrimaryP17TIM_HandleTypeDefmt
 228              	.LVL30:
  29:Core/Src/devs/wheel.cpp **** 
 229              		.loc 1 29 0
 230 000c 08BD     		pop	{r3, pc}
 231              		.cfi_endproc
 232              	.LFE407:
ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 6


 234              		.global	__aeabi_f2d
 235              		.global	__aeabi_ddiv
 236              		.global	__aeabi_dmul
 237              		.global	__aeabi_d2uiz
 238              		.section	.text._ZL14set_WheelOmegaP12Wheel_Configf,"ax",%progbits
 239              		.align	1
 240              		.syntax unified
 241              		.thumb
 242              		.thumb_func
 243              		.fpu fpv4-sp-d16
 245              	_ZL14set_WheelOmegaP12Wheel_Configf:
 246              	.LFB409:
  49:Core/Src/devs/wheel.cpp **** 
  50:Core/Src/devs/wheel.cpp **** static void set_WheelOmega(Wheel_Config *w, float omega)
  51:Core/Src/devs/wheel.cpp **** {
 247              		.loc 1 51 0
 248              		.cfi_startproc
 249              		@ args = 0, pretend = 0, frame = 0
 250              		@ frame_needed = 0, uses_anonymous_args = 0
 251              	.LVL31:
 252 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 253              	.LCFI4:
 254              		.cfi_def_cfa_offset 24
 255              		.cfi_offset 3, -24
 256              		.cfi_offset 4, -20
 257              		.cfi_offset 5, -16
 258              		.cfi_offset 6, -12
 259              		.cfi_offset 7, -8
 260              		.cfi_offset 14, -4
 261 0002 0446     		mov	r4, r0
 262 0004 10EE105A 		vmov	r5, s0
  52:Core/Src/devs/wheel.cpp ****         uint16_t new_omega = (65535.0 / w->max_omega) * (omega);
 263              		.loc 1 52 0
 264 0008 806A     		ldr	r0, [r0, #40]	@ float
 265              	.LVL32:
 266 000a FFF7FEFF 		bl	__aeabi_f2d
 267              	.LVL33:
 268 000e 0246     		mov	r2, r0
 269 0010 0B46     		mov	r3, r1
 270 0012 0BA1     		adr	r1, .L22
 271 0014 D1E90001 		ldrd	r0, [r1]
 272 0018 FFF7FEFF 		bl	__aeabi_ddiv
 273              	.LVL34:
 274 001c 0646     		mov	r6, r0
 275 001e 0F46     		mov	r7, r1
 276 0020 2846     		mov	r0, r5	@ float
 277 0022 FFF7FEFF 		bl	__aeabi_f2d
 278              	.LVL35:
 279 0026 0246     		mov	r2, r0
 280 0028 0B46     		mov	r3, r1
 281 002a 3046     		mov	r0, r6
 282 002c 3946     		mov	r1, r7
 283 002e FFF7FEFF 		bl	__aeabi_dmul
 284              	.LVL36:
 285 0032 FFF7FEFF 		bl	__aeabi_d2uiz
 286              	.LVL37:
  53:Core/Src/devs/wheel.cpp ****         set_DutyCycle(w, new_omega);
ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 7


 287              		.loc 1 53 0
 288 0036 81B2     		uxth	r1, r0
 289 0038 2046     		mov	r0, r4
 290              	.LVL38:
 291 003a FFF7FEFF 		bl	_ZL13set_DutyCycleP12Wheel_Configt
 292              	.LVL39:
  54:Core/Src/devs/wheel.cpp **** }
 293              		.loc 1 54 0
 294 003e F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 295              	.LVL40:
 296              	.L23:
 297              		.align	3
 298              	.L22:
 299 0040 00000000 		.word	0
 300 0044 E0FFEF40 		.word	1089470432
 301              		.cfi_endproc
 302              	.LFE409:
 304              		.section	.text._ZN5Wheel13start_PeriphsEv,"ax",%progbits
 305              		.align	1
 306              		.global	_ZN5Wheel13start_PeriphsEv
 307              		.syntax unified
 308              		.thumb
 309              		.thumb_func
 310              		.fpu fpv4-sp-d16
 312              	_ZN5Wheel13start_PeriphsEv:
 313              	.LFB410:
  55:Core/Src/devs/wheel.cpp **** 
  56:Core/Src/devs/wheel.cpp **** /**
  57:Core/Src/devs/wheel.cpp ****  * @brief Function that starts timer base, pwm and encoder of the wheel
  58:Core/Src/devs/wheel.cpp ****  * @retval None
  59:Core/Src/devs/wheel.cpp ****  * 
  60:Core/Src/devs/wheel.cpp ****  * 
  61:Core/Src/devs/wheel.cpp ****  * <pre>
  62:Core/Src/devs/wheel.cpp ****  * Tasks performed by this function :
  63:Core/Src/devs/wheel.cpp ****  * 1) Starts Timer associated with the wheel
  64:Core/Src/devs/wheel.cpp ****  * 2) Starts PWM of the wheel
  65:Core/Src/devs/wheel.cpp ****  * 3) Starts Encoder of the wheel
  66:Core/Src/devs/wheel.cpp ****  * </pre> 
  67:Core/Src/devs/wheel.cpp ****  */
  68:Core/Src/devs/wheel.cpp **** void Wheel::start_Periphs()
  69:Core/Src/devs/wheel.cpp **** {
 314              		.loc 1 69 0
 315              		.cfi_startproc
 316              		@ args = 0, pretend = 0, frame = 0
 317              		@ frame_needed = 0, uses_anonymous_args = 0
 318              	.LVL41:
 319 0000 10B5     		push	{r4, lr}
 320              	.LCFI5:
 321              		.cfi_def_cfa_offset 8
 322              		.cfi_offset 4, -8
 323              		.cfi_offset 14, -4
 324 0002 0446     		mov	r4, r0
  70:Core/Src/devs/wheel.cpp ****         HAL_TIM_Base_Start(wheel_->htim);
 325              		.loc 1 70 0
 326 0004 0368     		ldr	r3, [r0]
 327 0006 9869     		ldr	r0, [r3, #24]
 328              	.LVL42:
ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 8


 329 0008 FFF7FEFF 		bl	HAL_TIM_Base_Start
 330              	.LVL43:
  71:Core/Src/devs/wheel.cpp ****         
  72:Core/Src/devs/wheel.cpp ****         HAL_TIM_PWM_Start(wheel_->htim, wheel_->channel);
 331              		.loc 1 72 0
 332 000c 2368     		ldr	r3, [r4]
 333 000e D969     		ldr	r1, [r3, #28]
 334 0010 9869     		ldr	r0, [r3, #24]
 335 0012 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 336              	.LVL44:
  73:Core/Src/devs/wheel.cpp ****         HAL_TIM_Encoder_Start(wheel_->henc, TIM_CHANNEL_ALL);
 337              		.loc 1 73 0
 338 0016 2368     		ldr	r3, [r4]
 339 0018 1821     		movs	r1, #24
 340 001a 186A     		ldr	r0, [r3, #32]
 341 001c FFF7FEFF 		bl	HAL_TIM_Encoder_Start
 342              	.LVL45:
  74:Core/Src/devs/wheel.cpp **** }
 343              		.loc 1 74 0
 344 0020 10BD     		pop	{r4, pc}
 345              		.cfi_endproc
 346              	.LFE410:
 348              		.section	.text._ZN5Wheel9set_OmegaEf,"ax",%progbits
 349              		.align	1
 350              		.global	_ZN5Wheel9set_OmegaEf
 351              		.syntax unified
 352              		.thumb
 353              		.thumb_func
 354              		.fpu fpv4-sp-d16
 356              	_ZN5Wheel9set_OmegaEf:
 357              	.LFB411:
  75:Core/Src/devs/wheel.cpp **** 
  76:Core/Src/devs/wheel.cpp **** /**
  77:Core/Src/devs/wheel.cpp ****  * @brief Function that sets the angular velocity of the wheel
  78:Core/Src/devs/wheel.cpp ****  * @param omega The new angular of the wheel
  79:Core/Src/devs/wheel.cpp ****  * @retval None
  80:Core/Src/devs/wheel.cpp ****  * 
  81:Core/Src/devs/wheel.cpp ****  * @note This function <b>does not</b> actually update the value of the wheel.
  82:Core/Src/devs/wheel.cpp ****  *       The update() function need to be called separately for new value to be
  83:Core/Src/devs/wheel.cpp ****  *       updated.
  84:Core/Src/devs/wheel.cpp ****  * 
  85:Core/Src/devs/wheel.cpp ****  * 
  86:Core/Src/devs/wheel.cpp ****  * <pre>
  87:Core/Src/devs/wheel.cpp ****  * Tasks performed by this function :
  88:Core/Src/devs/wheel.cpp ****  * 1) Sets the direction of the wheel according to the sign of omega
  89:Core/Src/devs/wheel.cpp ****  * 2) Sets the omega of the wheel
  90:Core/Src/devs/wheel.cpp ****  * </pre>
  91:Core/Src/devs/wheel.cpp ****  */
  92:Core/Src/devs/wheel.cpp **** void Wheel::set_Omega(float omega)
  93:Core/Src/devs/wheel.cpp **** {
 358              		.loc 1 93 0
 359              		.cfi_startproc
 360              		@ args = 0, pretend = 0, frame = 0
 361              		@ frame_needed = 0, uses_anonymous_args = 0
 362              		@ link register save eliminated.
 363              	.LVL46:
  94:Core/Src/devs/wheel.cpp ****         if (omega < -wheel_->tolerance) {
ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 9


 364              		.loc 1 94 0
 365 0000 0368     		ldr	r3, [r0]
 366 0002 D3ED097A 		vldr.32	s15, [r3, #36]
 367 0006 B1EE677A 		vneg.f32	s14, s15
 368 000a B4EEC07A 		vcmpe.f32	s14, s0
 369 000e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 370 0012 07DC     		bgt	.L36
  95:Core/Src/devs/wheel.cpp ****                 dir_ = Direction::BACK;
  96:Core/Src/devs/wheel.cpp ****         }
  97:Core/Src/devs/wheel.cpp ****         else if (omega > wheel_->tolerance) {
 371              		.loc 1 97 0
 372 0014 F4EEC07A 		vcmpe.f32	s15, s0
 373 0018 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 374 001c 09D4     		bmi	.L37
  98:Core/Src/devs/wheel.cpp ****                 dir_ = Direction::AHEAD;
  99:Core/Src/devs/wheel.cpp ****         }
 100:Core/Src/devs/wheel.cpp ****         else {
 101:Core/Src/devs/wheel.cpp ****                 dir_ = Direction::HALT;
 375              		.loc 1 101 0
 376 001e 0223     		movs	r3, #2
 377 0020 0371     		strb	r3, [r0, #4]
 378 0022 01E0     		b	.L29
 379              	.L36:
  95:Core/Src/devs/wheel.cpp ****                 dir_ = Direction::BACK;
 380              		.loc 1 95 0
 381 0024 0123     		movs	r3, #1
 382 0026 0371     		strb	r3, [r0, #4]
 383              	.L29:
 102:Core/Src/devs/wheel.cpp ****                 omega_ = 0;
 103:Core/Src/devs/wheel.cpp ****         }
 104:Core/Src/devs/wheel.cpp ****         omega_ = fabsf(omega);
 384              		.loc 1 104 0
 385 0028 B0EEC00A 		vabs.f32	s0, s0
 386              	.LVL47:
 387 002c 80ED020A 		vstr.32	s0, [r0, #8]
 105:Core/Src/devs/wheel.cpp **** }
 388              		.loc 1 105 0
 389 0030 7047     		bx	lr
 390              	.LVL48:
 391              	.L37:
  98:Core/Src/devs/wheel.cpp ****                 dir_ = Direction::AHEAD;
 392              		.loc 1 98 0
 393 0032 0023     		movs	r3, #0
 394 0034 0371     		strb	r3, [r0, #4]
 395 0036 F7E7     		b	.L29
 396              		.cfi_endproc
 397              	.LFE411:
 399              		.section	.text._ZNK5Wheel6updateEv,"ax",%progbits
 400              		.align	1
 401              		.global	_ZNK5Wheel6updateEv
 402              		.syntax unified
 403              		.thumb
 404              		.thumb_func
 405              		.fpu fpv4-sp-d16
 407              	_ZNK5Wheel6updateEv:
 408              	.LFB412:
 106:Core/Src/devs/wheel.cpp **** 
ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 10


 107:Core/Src/devs/wheel.cpp **** void Wheel::update() const
 108:Core/Src/devs/wheel.cpp **** {
 409              		.loc 1 108 0
 410              		.cfi_startproc
 411              		@ args = 0, pretend = 0, frame = 0
 412              		@ frame_needed = 0, uses_anonymous_args = 0
 413              	.LVL49:
 414 0000 10B5     		push	{r4, lr}
 415              	.LCFI6:
 416              		.cfi_def_cfa_offset 8
 417              		.cfi_offset 4, -8
 418              		.cfi_offset 14, -4
 419 0002 0446     		mov	r4, r0
 109:Core/Src/devs/wheel.cpp ****         if (omega_ < 0) {
 420              		.loc 1 109 0
 421 0004 D0ED027A 		vldr.32	s15, [r0, #8]
 422 0008 F5EEC07A 		vcmpe.f32	s15, #0
 423 000c F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 424 0010 09D4     		bmi	.L43
 425              	.LVL50:
 426              	.L39:
 110:Core/Src/devs/wheel.cpp ****                 _Error_Handler(__FILE__, __LINE__);
 111:Core/Src/devs/wheel.cpp ****         }
 112:Core/Src/devs/wheel.cpp ****         set_WheelDirection(wheel_, dir_);
 427              		.loc 1 112 0
 428 0012 2179     		ldrb	r1, [r4, #4]	@ zero_extendqisi2
 429 0014 2068     		ldr	r0, [r4]
 430 0016 FFF7FEFF 		bl	_ZL18set_WheelDirectionP12Wheel_Config9Direction
 431              	.LVL51:
 113:Core/Src/devs/wheel.cpp ****         set_WheelOmega(wheel_, omega_);
 432              		.loc 1 113 0
 433 001a 94ED020A 		vldr.32	s0, [r4, #8]
 434 001e 2068     		ldr	r0, [r4]
 435 0020 FFF7FEFF 		bl	_ZL14set_WheelOmegaP12Wheel_Configf
 436              	.LVL52:
 114:Core/Src/devs/wheel.cpp **** }
 437              		.loc 1 114 0
 438 0024 10BD     		pop	{r4, pc}
 439              	.LVL53:
 440              	.L43:
 110:Core/Src/devs/wheel.cpp ****                 _Error_Handler(__FILE__, __LINE__);
 441              		.loc 1 110 0
 442 0026 6E21     		movs	r1, #110
 443 0028 0148     		ldr	r0, .L44
 444              	.LVL54:
 445 002a FFF7FEFF 		bl	_Error_Handler
 446              	.LVL55:
 447 002e F0E7     		b	.L39
 448              	.L45:
 449              		.align	2
 450              	.L44:
 451 0030 00000000 		.word	.LC0
 452              		.cfi_endproc
 453              	.LFE412:
 455              		.global	__aeabi_ui2d
 456              		.global	__aeabi_d2f
 457              		.section	.text._ZN5Wheel9get_OmegaEm,"ax",%progbits
ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 11


 458              		.align	1
 459              		.global	_ZN5Wheel9get_OmegaEm
 460              		.syntax unified
 461              		.thumb
 462              		.thumb_func
 463              		.fpu fpv4-sp-d16
 465              	_ZN5Wheel9get_OmegaEm:
 466              	.LFB414:
 115:Core/Src/devs/wheel.cpp **** 
 116:Core/Src/devs/wheel.cpp **** // Calculating Omega Ratio When Encoder is used in TI12 mode
 117:Core/Src/devs/wheel.cpp **** inline float omegaRatioTI12(uint32_t ppr)
 118:Core/Src/devs/wheel.cpp **** {
 119:Core/Src/devs/wheel.cpp ****         return (2.0 * M_PI / (4.0 * ppr));
 120:Core/Src/devs/wheel.cpp **** }
 121:Core/Src/devs/wheel.cpp **** 
 122:Core/Src/devs/wheel.cpp **** float Wheel::get_Omega(uint32_t dt_millis)
 123:Core/Src/devs/wheel.cpp **** {
 467              		.loc 1 123 0
 468              		.cfi_startproc
 469              		@ args = 0, pretend = 0, frame = 0
 470              		@ frame_needed = 0, uses_anonymous_args = 0
 471              	.LVL56:
 472 0000 10B5     		push	{r4, lr}
 473              	.LCFI7:
 474              		.cfi_def_cfa_offset 8
 475              		.cfi_offset 4, -8
 476              		.cfi_offset 14, -4
 477 0002 2DED028B 		vpush.64	{d8}
 478              	.LCFI8:
 479              		.cfi_def_cfa_offset 16
 480              		.cfi_offset 80, -16
 481              		.cfi_offset 81, -12
 124:Core/Src/devs/wheel.cpp ****         float dt = (float)dt_millis / 1000.0;
 482              		.loc 1 124 0
 483 0006 07EE901A 		vmov	s15, r1	@ int
 484 000a B8EE677A 		vcvt.f32.u32	s14, s15
 485 000e DFED167A 		vldr.32	s15, .L48+8
 486 0012 87EE278A 		vdiv.f32	s16, s14, s15
 487              	.LVL57:
 125:Core/Src/devs/wheel.cpp ****         // Get count and reset the counter
 126:Core/Src/devs/wheel.cpp ****         int16_t counts = wheel_->henc->Instance->CNT;
 488              		.loc 1 126 0
 489 0016 0368     		ldr	r3, [r0]
 490 0018 1B6A     		ldr	r3, [r3, #32]
 491 001a 1A68     		ldr	r2, [r3]
 492 001c 546A     		ldr	r4, [r2, #36]
 493 001e 24B2     		sxth	r4, r4
 494              	.LVL58:
 127:Core/Src/devs/wheel.cpp ****         wheel_->henc->Instance->CNT = 0;
 495              		.loc 1 127 0
 496 0020 0023     		movs	r3, #0
 497 0022 5362     		str	r3, [r2, #36]
 128:Core/Src/devs/wheel.cpp **** 
 129:Core/Src/devs/wheel.cpp ****         // w = 2*pi*f
 130:Core/Src/devs/wheel.cpp ****         // f = (counts / ppr) / dt;
 131:Core/Src/devs/wheel.cpp ****         // Nagating to make count compatible with earlier version
 132:Core/Src/devs/wheel.cpp ****         float omega = (-1)*omegaRatioTI12(wheel_->enc_ppr) * counts / dt;
ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 12


 498              		.loc 1 132 0
 499 0024 0368     		ldr	r3, [r0]
 500              	.LVL59:
 501              	.LBB4:
 502              	.LBB5:
 119:Core/Src/devs/wheel.cpp **** }
 503              		.loc 1 119 0
 504 0026 D86A     		ldr	r0, [r3, #44]
 505              	.LVL60:
 506 0028 FFF7FEFF 		bl	__aeabi_ui2d
 507              	.LVL61:
 508 002c 0022     		movs	r2, #0
 509 002e 0F4B     		ldr	r3, .L48+12
 510 0030 FFF7FEFF 		bl	__aeabi_dmul
 511              	.LVL62:
 512 0034 0246     		mov	r2, r0
 513 0036 0B46     		mov	r3, r1
 514 0038 09A1     		adr	r1, .L48
 515 003a D1E90001 		ldrd	r0, [r1]
 516 003e FFF7FEFF 		bl	__aeabi_ddiv
 517              	.LVL63:
 518 0042 FFF7FEFF 		bl	__aeabi_d2f
 519              	.LVL64:
 520              	.LBE5:
 521              	.LBE4:
 522              		.loc 1 132 0
 523 0046 07EE904A 		vmov	s15, r4	@ int
 524 004a B8EEE70A 		vcvt.f32.s32	s0, s15
 525 004e 07EE900A 		vmov	s15, r0
 526 0052 27EEC00A 		vnmul.f32	s0, s15, s0
 527              	.LVL65:
 133:Core/Src/devs/wheel.cpp **** 
 134:Core/Src/devs/wheel.cpp ****         return omega;
 135:Core/Src/devs/wheel.cpp **** }...
 528              		.loc 1 135 0
 529 0056 80EE080A 		vdiv.f32	s0, s0, s16
 530              	.LVL66:
 531 005a BDEC028B 		vldm	sp!, {d8}
 532              	.LCFI9:
 533              		.cfi_restore 80
 534              		.cfi_restore 81
 535              		.cfi_def_cfa_offset 8
 536              	.LVL67:
 537 005e 10BD     		pop	{r4, pc}
 538              	.LVL68:
 539              	.L49:
 540              		.align	3
 541              	.L48:
 542 0060 182D4454 		.word	1413754136
 543 0064 FB211940 		.word	1075388923
 544 0068 00007A44 		.word	1148846080
 545 006c 00001040 		.word	1074790400
 546              		.cfi_endproc
 547              	.LFE414:
 549              		.section	.rodata._ZL11time_periodt.str1.4,"aMS",%progbits,1
 550              		.align	2
 551              	.LC0:
ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 13


 552 0000 436F7265 		.ascii	"Core/Src/devs/wheel.cpp\000"
 552      2F537263 
 552      2F646576 
 552      732F7768 
 552      65656C2E 
 553              		.text
 554              	.Letext0:
 555              		.file 2 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 556              		.file 3 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 557              		.file 4 "C:/Users/n-is/STM32Cube/Repository/STM32Cube_FW_F4_V1.23.0/Drivers/CMSIS/Include/core_cm4
 558              		.file 5 "C:/Users/n-is/STM32Cube/Repository/STM32Cube_FW_F4_V1.23.0/Drivers/CMSIS/Device/ST/STM32F
 559              		.file 6 "C:/Users/n-is/STM32Cube/Repository/STM32Cube_FW_F4_V1.23.0/Drivers/CMSIS/Device/ST/STM32F
 560              		.file 7 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 561              		.file 8 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include\
 562              		.file 9 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\lib\\gcc\\arm-none-eabi
 563              		.file 10 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include
 564              		.file 11 "C:/Users/n-is/STM32Cube/Repository/STM32Cube_FW_F4_V1.23.0/Drivers/STM32F4xx_HAL_Driver/
 565              		.file 12 "C:/Users/n-is/STM32Cube/Repository/STM32Cube_FW_F4_V1.23.0/Drivers/STM32F4xx_HAL_Driver/
 566              		.file 13 "C:/Users/n-is/STM32Cube/Repository/STM32Cube_FW_F4_V1.23.0/Drivers/STM32F4xx_HAL_Driver/
 567              		.file 14 "C:/Users/n-is/STM32Cube/Repository/STM32Cube_FW_F4_V1.23.0/Drivers/STM32F4xx_HAL_Driver/
 568              		.file 15 "Core/Inc/periphs/tim.h"
 569              		.file 16 "Core/Inc/utils\\control/pid.h"
 570              		.file 17 "Core/Inc/utils\\control/pid_algorithms.h"
 571              		.file 18 "Core/Inc/devs/wheel.h"
 572              		.file 19 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include
 573              		.file 20 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include
 574              		.file 21 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include
 575              		.file 22 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include
 576              		.file 23 "c:\\program files (x86)\\gnu tools arm embedded\\7 2017-q4-major\\arm-none-eabi\\include
 577              		.file 24 "Core/Inc/main.h"
 578              		.file 25 "<built-in>"
ARM GAS  C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s 			page 14


DEFINED SYMBOLS
                            *ABS*:00000000 wheel.cpp
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:18     .text._ZL11time_periodt:00000000 $t
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:24     .text._ZL11time_periodt:00000000 _ZL11time_periodt
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:63     .text._ZL11time_periodt:00000024 $d
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:69     .text._ZL18set_WheelDirectionP12Wheel_Config9Direction:00000000 $t
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:75     .text._ZL18set_WheelDirectionP12Wheel_Config9Direction:00000000 _ZL18set_WheelDirectionP12Wheel_Config9Direction
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:148    .text._Z21set_DutyCycle_PrimaryP17TIM_HandleTypeDefmt:00000000 $t
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:155    .text._Z21set_DutyCycle_PrimaryP17TIM_HandleTypeDefmt:00000000 _Z21set_DutyCycle_PrimaryP17TIM_HandleTypeDefmt
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:198    .text._Z21set_DutyCycle_PrimaryP17TIM_HandleTypeDefmt:00000030 $d
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:203    .text._ZL13set_DutyCycleP12Wheel_Configt:00000000 $t
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:209    .text._ZL13set_DutyCycleP12Wheel_Configt:00000000 _ZL13set_DutyCycleP12Wheel_Configt
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:239    .text._ZL14set_WheelOmegaP12Wheel_Configf:00000000 $t
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:245    .text._ZL14set_WheelOmegaP12Wheel_Configf:00000000 _ZL14set_WheelOmegaP12Wheel_Configf
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:299    .text._ZL14set_WheelOmegaP12Wheel_Configf:00000040 $d
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:305    .text._ZN5Wheel13start_PeriphsEv:00000000 $t
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:312    .text._ZN5Wheel13start_PeriphsEv:00000000 _ZN5Wheel13start_PeriphsEv
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:349    .text._ZN5Wheel9set_OmegaEf:00000000 $t
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:356    .text._ZN5Wheel9set_OmegaEf:00000000 _ZN5Wheel9set_OmegaEf
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:400    .text._ZNK5Wheel6updateEv:00000000 $t
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:407    .text._ZNK5Wheel6updateEv:00000000 _ZNK5Wheel6updateEv
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:451    .text._ZNK5Wheel6updateEv:00000030 $d
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:458    .text._ZN5Wheel9get_OmegaEm:00000000 $t
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:465    .text._ZN5Wheel9get_OmegaEm:00000000 _ZN5Wheel9get_OmegaEm
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:542    .text._ZN5Wheel9get_OmegaEm:00000060 $d
C:\Users\073be\AppData\Local\Temp\ccFDbgJa.s:550    .rodata._ZL11time_periodt.str1.4:00000000 $d

UNDEFINED SYMBOLS
_Error_Handler
HAL_GPIO_WritePin
__aeabi_f2d
__aeabi_ddiv
__aeabi_dmul
__aeabi_d2uiz
HAL_TIM_Base_Start
HAL_TIM_PWM_Start
HAL_TIM_Encoder_Start
__aeabi_ui2d
__aeabi_d2f
